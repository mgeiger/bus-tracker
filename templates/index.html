{% extends "base.html" %}

{% block title %}Data Entry{% endblock %}

{% block content %}
    <h1 class="mb-4">Data Entry</h1>
    <div class="card p-4">
        <form id="dataForm">
            <div class="mb-3">
                <label for="date" class="form-label">Date:</label>
                <input type="date" id="date" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="time" class="form-label">Time:</label>
                <input type="time" id="time" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="type" class="form-label">Type:</label>
                <select id="type" class="form-select" required>
                    <option value="departure">Departure</option>
                    <option value="arrival">Arrival</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        <div id="message" class="mt-3"></div>
    </div>
{% endblock %}

{% block scripts_extra %}
    <script>
        // Set the default date and time
        const now = new Date();
        const year = now.getFullYear();
        const month = (now.getMonth() + 1).toString().padStart(2, '0');
        const day = now.getDate().toString().padStart(2, '0');
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');

        document.getElementById('date').value = `${year}-${month}-${day}`;
        document.getElementById('time').value = `${hours}:${minutes}`;

        // Handle form submission
        document.getElementById('dataForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;
            const type = document.getElementById('type').value;

            const response = await fetch('/api/submit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ date, time, type })
            });

            const result = await response.json();
            document.getElementById('message').innerText = result.message;
        });
    </script>
{% endblock %}
